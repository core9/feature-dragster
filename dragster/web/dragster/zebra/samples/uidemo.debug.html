<!DOCTYPE html>
<html>

<head>
    <META http-equiv="X-UA-Compatible" content="IE=9">
	<META HTTP-EQUIV="Pragma" CONTENT="no-cache">
	<META HTTP-EQUIV="Expires" CONTENT="-1">
	<link rel="stylesheet" type="text/css" media="screen" href="css/uidemo.css"/>

	<!--[if (gte IE 9)|(!IE)]><!-->
	<script src='../lib/zebra/easyoop.js' 	 type='text/javascript'></script>
    <script src='../lib/zebra/util.js' type='text/javascript'></script>
    <script src='../lib/zebra/io.js'    type='text/javascript'></script>
    <script src='../lib/zebra/data.js' type='text/javascript'></script>
    <script src='../lib/zebra/layout.js' type='text/javascript'></script>

    <script src='../lib/zebra/ui.webstuff.js' type='text/javascript'></script>
    <script src='../lib/zebra/canvas.js' type='text/javascript'></script>
    <script src='../lib/zebra/ui.js' type='text/javascript'></script>


    <script src='../lib/zebra/ui.TextField.js' type='text/javascript'></script>
    <script src='../lib/zebra/ui.list.js' type='text/javascript'></script>
    <script src='../lib/zebra/ui.window.js' type='text/javascript'></script>

    <script src='../lib/zebra/ui.tree.js' type='text/javascript'></script>
    <script src='../lib/zebra/ui.grid.js' type='text/javascript'></script>
    <script src='../lib/zebra/ui.designer.js' type='text/javascript'></script>


    <script src='demo/ui.demo.js' 	       type='text/javascript'></script>
    <script src='demo/ui.demo.layout.js'   type='text/javascript'></script>
    <script src='demo/ui.demo.basicui.js'  type='text/javascript'></script>
    <script src='demo/ui.demo.panels.js'   type='text/javascript'></script>
    <script src='demo/ui.demo.tree.js'     type='text/javascript'></script>
    <script src='demo/ui.demo.popup.js'    type='text/javascript'></script>
    <script src='demo/ui.demo.win.js'      type='text/javascript'></script>
    <script src='demo/ui.demo.grid.js'     type='text/javascript'></script>
    <script src='demo/ui.demo.designer.js' type='text/javascript'></script>

    <script type='text/javascript'>
		var desktop = null;

		function norm_demo(e) {
			if (e) {
				e.preventDefault();
			}
   			desktop.$context.restore();
   			document.getElementById("norm_demo_parent").removeChild(document.getElementById("norm_demo"));
   			desktop.root.repaint();
		}

		var ZebraTextRender = zebra.Class(zebra.ui.TextRender, [
			function(t) { this.$this(t, false); },

			function(t, reflection) {
				this.$super(t);
				this.setFont(new zebra.ui.Font("100px Futura, Helvetica, sans-serif"));
				this.image = zebra.ui.demo.zebra_pattern;
				this.hasReflection = reflection;
				this.reflectionGap = -40;
			},

			function getLineHeight() {
				return this.hasReflection ? this.font.height*2 + this.reflectionGap : this.font.height;
			},

			function paintLine2(g,x,y,line,d) { 
				var gradient = g.createLinearGradient(x, y, x, y + this.font.height);
				gradient.addColorStop(0.1, '#000');
				gradient.addColorStop(0.35, '#fff');
				gradient.addColorStop(0.65, '#fff');
			    gradient.addColorStop(1.0, '#000');
				g.fillStyle = gradient;
				g.fillText(this.getLine(line), x, y); 

				var prev = g.globalCompositeOperation;
				if (this.hasReflection) {
					// draw reflected text
					g.save();
					g.globalCompositeOperation = "source-over";
					g.scale(1, -1);
					g.font = this.font.s;
					g.fillStyle = "#fff";
					g.fillText(this.getLine(line), x, -y - this.font.height - 2*this.font.height - this.reflectionGap);
					g.scale(1, -1);

					// cut the gradient out of the reflected text 
					var gradient = g.createLinearGradient(x, y + this.font.height + this.reflectionGap, x, y + 2*d.height + this.reflectionGap);
					gradient.addColorStop(0.0, 'rgba(0,0,0,0.65)');
					gradient.addColorStop(1.0, '#000');
					g.fillStyle = gradient;
					g.fillRect(x, y + this.font.height + this.reflectionGap + 30, this.lineWidth(line), 2*this.font.height);
					g.restore();
				}
				
			//	g.globalCompositeOperation = "source-atop";
				g.fillStyle = this.pattern;
				g.fillRect(x, y, this.lineWidth(line), this.getLineHeight());
				g.globalCompositeOperation = prev;
			},

			function paint(g,x,y,w,h,d) {
				this.pattern = g.createPattern(this.image, 'repeat');
				this.$super(g,x,y,w,h,d);
			}
		]);

        zebra.ready(
			function() {
				eval(zebra.Import("ui", "layout"));

	        	desktop = new zCanvas("zCanvas");
				var root = desktop.root, nt = new Tabs(), prevSelected = -1;
	    	
	    		root.properties({
	    			padding: 4,
	    			border : new Border(),
	    			layout : new BorderLayout(),
	    			kids   : {
	    				CENTER: nt.properties({
	    					kids : { 
	    						"About": new Panel({
		    						padding: 8,
		    						layout : new BorderLayout(),
		    						kids   : {
		    							CENTER: new Panel({
		    								padding   : 8,
		    								layout    : new BorderLayout(),
		    								background: "gray",
		    								border    : new Border("white", 4, 8),
		    								kids      : {
		    									CENTER: new Panel({
		    										background: "black",
		    										layout    : new BorderLayout(8,16),
		    										padding   : 8,
		    										border    : new RoundBorder("lightGray", 4),
		    										kids      : {
		    											TOP: new Panel({
		    												layout : new FlowLayout(CENTER, CENTER, VERTICAL, 0),
		    												kids   : [ new Label(new ZebraTextRender("Zebra", true)).properties({
		    													font : new Font("Helvetica", 'bold', 100)
		    												}) ]
		    											}),
		    											CENTER : new Panel({ 
		    												layout: new FlowLayout(CENTER, TOP, HORIZONTAL, 12),
		    												kids  : [ new TextField(new zebra.data.Text(zebra.io.GET("demo/desc.txt"))).properties({ 
		    													color:"white",
		    													background: null,
		    													border: null,
		    													padding: 0,
		    													editable: false,
		    													cursorView: "black",
		    													font : new Font("Verdana", 14)
		    												}) ]
		    											}),
		    											BOTTOM: new Panel({
		    												layout: new FlowLayout(CENTER, TOP, HORIZONTAL, 12),
		    												kids  : [ new Label("Copyright (c) Andrei Vishneuski 2014") ]
		    											})
		    										}
		    									})
		    								}
		    							})
		    						}
		    					}),
								"Basic UI"     : new zebra.ui.demo.BasicUIDemo(),
								"Panels"       : new zebra.ui.demo.PanelsDemo(),
								"Tree"         : new zebra.ui.demo.TreeDemo(),
								"Menu"    	   : new zebra.ui.demo.PopupDemo(),
								"Tooltip & Win": new zebra.ui.demo.WinDemo(),
								"Layouts"      : new zebra.ui.demo.LayoutDemo(),
								"Grid"         : new zebra.ui.demo.GridDemo(),
								"Designer"     : new zebra.ui.demo.DesignerDemo(),
								"Zebra text"   : new Panel({
									layout  : new BorderLayout(8, 8),
									padding : 8,
									background: "gray",
									kids    : { 
										CENTER: new TextField(new ZebraTextRender("Zebra ...")).properties({
											cursorView    : "red",
											curW          : 3,
											selectionColor: "gray",
											background    : "black"
									    }),
									    TOP: new Label("Type using Zebra font in text editor :)").properties({
									    	font : "22px Futura, Helvetica, sans-serif",
									    	color: "white",
									    	padding: 8,
									    	border: new Border("white", 4, 8)
									    })
									}
								})
		    				} 
	    				})
	    			}
	    		});

				nt.bind(function (src, data) {
					if (prevSelected >= 0) src.kids[prevSelected].activated && src.kids[prevSelected].activated(false);
					src.kids[data].activated && src.kids[data].activated(true);
					prevSelected = data;
				});

				desktop.$context.save();
				//desktop.$context.scale(1.3, 1.3);
				//desktop.$context.rotate(0.3);
				
				root.repaint();
			},

			function() {
				var canvas = document.getElementById("zCanvas"), offx = 430, offy = 25, e = canvas;
	        	do {
	    			offx += parseInt(e.offsetLeft);
	    			offy += parseInt(e.offsetTop);
	    		} while (e = e.offsetParent);
				var pe = document.getElementById("norm_demo_parent"), ce = document.createElement("a");
				ce.setAttribute("href", "#");
				ce.setAttribute("id", "norm_demo");
				ce.setAttribute("onclick", "norm_demo();");
				ce.style.position = "absolute";
				ce.style.top = "" + offy + "px";
				ce.style.left = "" + offx + "px";
				ce.innerHTML = "<img border='0' src='demo/rotate.png'\/>";
				//pe.appendChild(ce);
			}
		);
    </script>
    <!--<![endif]-->
</head>

<body>


							<canvas id="zCanvas"
							        tabindex="1"
							        style="outline:none; background:transparent;"
							        style2="outline:none;"
							        class="zebracanvas"
							        width="750" height="550">
							</canvas>


</body>
</html>

